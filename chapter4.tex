\chapter{Πειραματική Αξιολόγηση}
\label{chap4}
\section{Πειραματική Διάταξη}
Για την αξιολόγηση του πακέτου \en{grakel} τρέξαμε στο ίδιο μηχάνημα (βάλε τα στοιχεία του) τον υπολογισμό του πλήρους kernel πίνακα μέσω της μεθόδου \en{fit\_transform} σε ένα εύρος τιμών (βλ πίνακα ταδε) και μία σειρά από συνόλων δεδομένων.
Ένα όριο τοποθετήθηκε στο μέγιστο χρόνο εκτέλεσης κάθε υπολογισμού καθώς και στην μέγιστη μνήμη \en{RAM} που μπορεί να καταναλώσει. 
Συγκεκριμένα για όλους τους υπολογισμούς τοποθετήθηκε το όριο της μίας μέρας (συμβολίζεται ως \en{\texttt{OOT}}) και των $64$\en{\texttt{GB}} (συμβολίζεται ως \en{\texttt{OOM}}).
Σε όλους τους αλγορίθμους για τους οποίους η επάυξηση μίας παραμέτρου αύξανε ή κρατούσε σταθερή την πολυπλοκότητα μνήμης και υπολογισμού μία τιμή προς δοκιμή αγνοήθηκε στην περίπτωση που για την προηγούμενη υπήρξε \en{\texttt{OOT}} ή \en{\texttt{OOM}}.
Στη συνέχεια έχοντας κρατήσει τις επισημειώσεις κάθε στοιχείου της μήτρας πυρήνα επιχειρήσαμε \en{10-fold cross validation} σε ένα ταξινομητή \en{SVM} με βάση την μετρική της ευστοχίας (βλ. \ref{subsection:accuracy}).
Συγκεκριμένα χρησιμοποιήσαμε τον ταξινομητή \en{\texttt{sklearn.svm.SVC}} που μας δίνει την δυνατότητα να λύσουμε το πρόβλημα \en{SVM} παρέχοντας μία προϋπολογισμένη μήτρα Γκραμ.
Λύνοντας αυτό το πρόβλημα υπολογίζουμε την μέγιστη μετρική ευστοχίας για ένα εύρος τιμών $C$ (βλ. \ref{eq:svm_basique}) που εξαρτόνται από την είσοδο και διαλέγουμε την μέγιστη.
Υπολογίζοντας την μέση τιμή των μέγιστων μετρικών ευστοχίας για όλα τα \en{fold} υπολογίζουμε την μέση τιμή και την διακυμανσή τους για 10 επαναλήψεις.
Τα \en{folds} ήταν κοινά για όλες τους πυρήνες που εκτελέστηκαν σε αυτό το \en{dataset}.
Τέλος καταγράφουμε σε συγκριτικούς πίνακε για κάθε \en{dataset} την μνήμη, τον χρόνο και την παραμετροποίηση για την οποία πέτυχε ο κάθε πυρήνα πέτυχε την μέγιστη ευστοχία, καθώς και την τιμή της.

\subsection{Μετρική Ευστοχίας}
\label{subsection:accuracy}
Για την αξιολόγηση των πυρήνων αναφέραμε πως χρησιμοποιούν την μετρική της ευστοχίας.
Συγκεκριμένα για ένα πρόβλημα διαδικής ταξινόμησης με θετικά και αρνητικά δείγματα υπάρχουν τέσσερεις δυνατές προβλέψεις:
\begin{enumerate}
    \item \en{True Positive (TP)} - το σύστημα προβλέπει σωστά μία θετική κλάση για ένα παράδειγμα που είναι θετικό
    \item \en{True Negative (TN)} - το σύστημα προβλέπει σωστά μία αρνητική κλάση για ένα αρνητικό παράδειγμα
    \item \en{False Positive (FP)} - το σύστημα προβλέπει σωστά μία λανθεσμένη κλάση για ένα λανθασμένο παράδειγμα
    \item \en{False Negative (FN)} - το σύστημα προβλέπει λανθασμένα μία θετική κλάση για ένα αρνητικό παράδειγμα
\end{enumerate}
Αυτή η πληροφορία συνήθως παρουσιάζεται σε ένα $2 \times 2$ πίνακα \textit{σύγχησης} (\en{confusion matrix}), όπως απεικονίζεται στον πίνακα 2.2.
Στη βάση των τεσσάρων παραπάνω προβλέψεων προκύπτουν διάφορες πολύ γνωστές μετρικές αξιολόγησης.
Αυτές οι μετρικές μετρούν ποσοτικά την επίδοση ταξινόμησης για μία μόνο μέθοδο σε ένα και μόνο σύνολο δεδομένων.
Στην ταξινόμηση γράφων, η πιο γνωστή μετρική είναι αυτή της ευστοχίας (\en{accuracy}), που ορίζεται ως:
\begin{equation}
    acc = \frac{TP + TN}{TP + TN + FP + FN}    
\end{equation}
Η ευστοχία υπολογίζει μία μέθοδο βάση του τμήματος των προβλέψεων τις που είναι σωστές.
Το κύριο μειονέκτημα της ευστοχίας είναι ότι στην περίπτωση μη ισορροπημένων κατανομών κατηγορίας, μπορεί να πάρει τεχνητά υψηλές τιμές.
Για παράδειγμα, αν σε ένα πρόβλημα δυαδική ταξινόμησης το $99$\% των παραδειγμάτω είναι θετικά, τότε ένας αλγόριθμος μπορεί να πετύχει $99$\% ευστοχία προβλέποντας μόνο την θετική κατηγορία!
Ως επίλυση σε αυτό το πρόλημα έχουν προταθεί άλλες μετρικές αξιολόγησης.

\begin{table}[]
\centering
\en{\begin{tabular}{ll|l|l|}
\cline{3-4}
                                                                                              &          & \multicolumn{2}{l|}{Predicted (Class)} \\ \cline{3-4} 
                                                                                              &          & Positive          & Negative         \\ \hline
\multicolumn{1}{|l|}{\multirow{2}{*}{\begin{tabular}[c]{@{}l@{}}\rotatebox{90}{Actual}\end{tabular}}} & Positive & TP                & FN               \\ \cline{2-4} 
\multicolumn{1}{|l|}{}                                                                        & Negative & FP                & TN               \\ \hline
\end{tabular}}
\caption{Πίνακας σύγχησης για ένα πρόβλημα δυαδικής ταξινόμησης.}
\label{tab:conf_mat}
\end{table}
Από την άλλη, όπως μπορεί να ειδωθεί στον πίνακα \ref{tab:conf_mat}, η πλειοψηφία των συνόλο δεδομένων που χρησιμοποιείται στην ταξινόμηση γράφων είναι σύνολα δεδομένων δυαδικής ταξινόμησης και στις περισσότερες περιπτώσεις, οι κλάσεις είναι ισορροπημένες.
Λόγω αυτής της παρατήρησης και προκειμένου τα αποτελέσματα να είναι συγκρίσιμα με προηγούμενες μελέτες, χρησιμοποιήσαμε την ευστοχία ως μέτρο αξιολόγησης.
\section{\en{Datasets}}
Η παραπάνω πειραματική διάταξη εφαρμόστηκε σε ένα μεγάλο εύρος συνόλο δεδομένων και πυρήνων γράφων με βάση το είδος τους.
\subsection{Χωρίς επισημειώσεις}
Για την αξιολόγηση πυρήνων που δέχονται ως είσοδο γράφους χωρίς επισημειώσεις, εκτελέσαμε τους πυρήνες ... στα παρακάτω σύνολα δεδομένων.
Προκειμένου οι πυρήνες με διακριτές και συνεχείς, να είναι εκτελέσιμοι στα ίδια σύνολα δεδομένων, αποδώσαμε σε κάθε κόμβο ή ακμή μία σταθερή έπισημείωση (τον αριθμό $1$) και ένα μοναδιαίο διάνυσμα ενός στοιχείου (\en{\texttt{numpy.array([1.0])}}) αντίστοιχα.
\paragraph*{\en{COLLAB}} Μία συλογή δεδομένων επιστημονικής συνεργασίας που αποτελείται από τα δίκτυα προσωπικότητας (\en{ego-networks}) αρκετών ερευνητών από τρία υποπεδία της φυσικής (Φυσική Υψηλών Ενεργειών, Φυσική Στερεάς Κατάστασης και της Αστροφυσικής).
Ο σκοπός είναι είναι να προσδιοριστεί το υποπεδίο της φυσικής στο οποίο ανήκει το  δίκτυα προσωπικότητας του κάθε ερευνητή \cite{DGK_PINAR}.

\paragraph*{\en{IMDB-BINARY IMDB-MULTI}}
Αυτά τα σύνολα δεδομένων δημιουργήθηκαν από το \en{IMDb} (\en{\texttt{www.imdb.com}}), μία \en{online} βάση δεδομένων με πληροφορίες που συνδέονται με ταινίες και προγράμματα τηλεόρασης.
Οι γράφοι που περιέχονται στα δύο σύνολα δεδομένων αντιστοιχούν correspond σε συνεργασίες εντός ταινιών.
Οι κόμβοι κάθε γράφου αναπαριστούν ηθοποιούς και δύο κόμβοι συνδέονται με μία ακμή αν οι αντίστοιχοι ηθοποιοί παίζουν στην ίδια ταινία.
Κάθε γράφος είναι ένα  δίκτυο προσωπικότητας ηθοποιών και ο στόχος είναι η πρόβλεψη της κατηγορίας ταινιών (\en{genre}) στην οποία ανήκει μία ταινία \cite{DGK_PINAR}.

\paragraph*{\en{REDDIT-BINARY REDDIT-MULTI-5k REDDIT-MULTI-12k}}
Οι γράφοι που περιέχονται σε αυτά τα τρία dataset αναπαριστούν κοινωνικές αλληλεπιδράσεις μεταξύ χρηστών του \en{Reddit} (\en{\texttt{www.reddit.com}}), ένα από τα πιο δημοφιλή μέσα κοινωνικής δίκτυωσης.
Κάθε γράφος αναπαριστά ένα νήμα συζήτησης στον ιστό.
Συγκεκριμένα, κάθε κόμβος αντιστοιχεί σε ένα χρήστη και δύο χρήστες συνδέονται από μία ακμή αν τουλάχιστον ένα από αυτούς αντίδρασε στο σχόλιο του άλλου.
Στόχος είναι η ταξινόμηση γράφων είτε σε κοινότητες είτε σε "υπο-reddit" (\en{subreddits}) \cite{DGK_PINAR}.

\subsection{Με διακριτές επισημειώσεις}
Για την αξιολόγηση πυρήνων που δέχονται ως είσοδο γράφους με \textbf{διακριτές} επισημειώσεις, εκτελέσαμε τους πυρήνες ... στα παρακάτω σύνολα δεδομένων.
Προκειμένου οι πυρήνες με συνεχείς, να είναι εκτελέσιμοι στα ίδια σύνολα δεδομένων, αποδώσαμε σε κάθε κόμβο ένα \textit{One-Hot Vector} με βάση το σύνολο όλων των επισημειώσεων που εμφανίζονται σε κάθε σύνολο δεδομένων.
\paragraph*{\en{MUTAG}} Αυτό το σύνολο δεδομένων αποτελείται από 188 μεταλλαξιογόνες αρωματικές-ετεροαρωματικές νιτρικές ενώσεις.
Ο στόχος είναι η πρόβλεψη του αν μία χημική ένωση έχει μεταλλαξιγόνα δράση στο αρνητικό κατά Γκραμ βακτήριο \en{Salmonella typhimurium} \cite{shervashidze2011weisfeiler}.

\paragraph*{\en{ENZYMES}} Αποτελείται από $600$ τριτογενείς δομές προτεϊνών που ανήκουν στην βάση ενζύμων \en{BRENDA}.
Κάθε ένζυμο ειναί ταξινομημένο στην αφηρημένη κατάταξης \en{\href{https://en.wikipedia.org/wiki/Enzyme_Commission_number}{Enzyme Commission}} και ο σκοπός είναι ο ορθός προσδιορισμός της κλάσης στην οποία ανήκει ένα ένζυμο \cite{Borgwardt2005}.

\paragraph*{\en{DD}} Αυτό το σύνολο δεδομένων περιέχει πάνω από χίλιες δομές πρωτεϊνών.
Κάθε πρωτεΐνη είναι ένας γράφος που οι κόμβοι του αντιστοιχούν σε αμινοξέα και ένα ζευγάρι αμινοξέων συνδέεται με μία ακμή αν η απόσταση τους είναι λιγότερη από 6 \en{Ångstrom}.
Στόχος είναι να προβλέψουμε αν μία πρωτεΐνη είναι ένζυμο (ή όχι) \cite{DobsonDoig03}.

\paragraph*{\en{NCI1}} Αυτό το σύνολο δεδομένων περιέχει μερικές χιλιάδες χημικά στοιχεία στα οποία καταγράφεται η δραστηριότητα τους απέναντι σε καρκινικά κύταρα του πνεύμονα και των ωοθηκών βάση της πορείας κυτταρικής διαίρεσης τους (\en{cell lines}) σε ελεγχόμενες συνθήκες εργαστηρίου \cite{Wale2008}.

\paragraph*{\en{PTC\_MR}} Αυτό το σύνολο δεδομένων περιέχει 344 οργανικά μόρια που έχουν αναπαραστηθεί ως γράφοι.
Στόχος είναι η πρόβλεψη καρκινογένεσης σε αρσινικούς αρουραίους \cite{Toivonen2003}.

\paragraph*{\en{AIDS}} Αποτελείται από $2000$ χημικές ενώσεις αναπαραστημένως ως γράφους οι οποίες έχουν δοκιμαστεί για την αποτελεσματικότητα απέναντι στον ιό \en{HIV}. Σκοπός λοιπόν του προβλήματος ταξινόμησης είναι η πρόβλεψη του καταπόσο μία χημική ένωση μπορεί να είναι ή όχι αποτελεσματική απέναντι στον ιό \cite{Riesen08}.

\paragraph*{\en{PROTEINS}} Περιέχει πρωτεΐνες αναπαραστιμένες ως γράφους όπου οι κόμβοι είναι δευτερογενή δομικά στοιχεία και μία ακμή υπάρχει μεταξύ των κόμβων αν οι κόμβοι είναι γείτονες στην ακολουθία αμινοξέων ή στον 3σδιάστατο χώρο.
Σκοπός είναι η ταξινόμηση μίας πρωτεΐνης ως ένζυμο (ή όχι) \cite{borgwardt2005protein}.

\subsection*{Με επισημειώσεις χαρακτηρηστικών}
Για την αξιολόγηση πυρήνων που δέχονται ως είσοδο γράφους με \textbf{συνεχείς} επισημειώσεις, εκτελέσαμε τους πυρήνες ... στα παρακάτω σύνολα δεδομένων.

\paragraph*{\en{ENZYMES}} Αποτελείται από $600$ τριτογενείς δομές προτεϊνών που ανήκουν στην βάση ενζύμων \en{BRENDA}.
Κάθε ένζυμο ειναί ταξινομημένο στην αφηρημένη κατάταξης \en{\href{https://en.wikipedia.org/wiki/Enzyme_Commission_number}{Enzyme Commission}} και ο σκοπός είναι ο ορθός προσδιορισμός της κλάσης στην οποία ανήκει ένα ένζυμο \cite{Borgwardt2005}.

\paragraph*{\en{Synthie}} Είναι ένα τεχνητό σύνολο δεδομένων που αποτελείται από $400$ γράφους.
Το σύνολο δεδομένων υποδιαιρείται σε $4$ κατηγορίες.
Kάθε κόμβος επισημειώνεται με ένα διάνυσμα $15$ στοιχείων.
Για την κατασκευή του παράγονται δύο σύνολα με διαφορετική παραμετροποίηση $200$ γράφων \en{Erdös-Rényi} όπου το 25\% των ακμών τους αφαιρείται τυχαία, ενώ κατηγοριοποιούνται σε δύο κλάσεις, διαλέγοντας και συνδέοντας τυχαία $10$ γράφους με πιθανότητα 0.8 και 0.2 από το πρώτο και το δεύτερο σύνολο αντίστοιχα για την πρώτη κατηγορία και με αντίστροφες πιθανότητες για την δεύτερη κατηγορία.
Έπειτα δημιουργώντας δύο σύνολα χαρακτηρηστικών 15-διάστατων διανυσμάτων δύο κατηγοριών οι παραπάνω δύο κατηγορίες χωρίζονται σε άλλες δύο όπου στο καθένα για την πρώτη αν ένα κόμβος προερχόταν από το πρώτο σύνολο γράφων επισημειώνεται τυχαία με ένα διάνυσμα του πρώτου συνόλου χαρακτηρηστικών ενώ σε αντίθετη περίπτωση με διάνυσμα του δεύτερου.
Για την παραγωγή της δεύτερης κατηγορίας συμβαίνει το αντίθετο.
Στόχος το προβλήματος ταξινόμησης είναι βάση των χαρακτηρηστικών, να ανιχνευθεί σε ποιά από τις τέσσερεις υποκατηγορίες ανήκει ένας γράφος \cite{Morris16}.

\paragraph*{\en{BZR}} Αυτό το σύνολο δεδομένων αποτελεί από $684$ χημικές ενώσεις κατηγοριοποιημένες ως μεταλαξιογόνες ή μη βάση ενός πειράματoς γνωστό ως \en{Salmonella/microsome assay}.
Αυτό το σύνολο δεδομένων είναι ισοβαρισμένο με $341$ μεταλαξιογόνες χημικές ενώσεις και $343$ μη-μεταλαξιογόνες \cite{mahe2009graph, Neumann2016}.

\paragraph*{\en{PROTEINS\_full}}

\cite{DobsonDoig03, borgwardt2005protein, Neumann2016}

\paragraph*{\en{SYNTHETICnew}} είναι ένα τεχνητό σύνολο δεδομένων $300$ τυχαία δειγματοληπτημένων γράφων που αποτλούνται από $100$ κόμβους και $196$ ακμές, που στους κόμβους των οποίων ανατίθενται μονοδιάστατες συνεχείς επισημειώσεις από το $\mathcal{N}(0, 1)$.
Έπειτα δύο ισοβαριμένες κατηγορίες $150$ επισημειώνων δημιουργούνται αφαιρώντας και επαναπροσθέτοντας τυχαία $5$ ακμές και μεταθέτοντας τυχαία τις επισημειώσεις $10$ κόμβων για την πρώτη κατηγορία και $10$, $5$ για την δεύτερη προσθέτοντας στο τέλος τυχαίο θόρυβο σε όλες τις επισημειώσεις από την $\mathcal{N}(0, 0.452)$ \cite{Feragen13}.
\newline \\
Όλα τα σύνολα δεδομένων που αναφέρθηκαν παραπάνω προέρχονται από το \cite{KKMMN2016}. Στατιστικά στοιχεία και πληροφορίες σχετικά με την ύπαρξη και τον τύπο των επισημείωσεων τους παρουσιάζονται συνοπτικά στον πίνακα \ref{ref:dataset_statistics}.

\begin{table}[]
\centering
\begin{adjustbox}{angle=90}
\resizebox{1\textheight}{!}{
\en{
\begin{tabularx}{0.861\textheight}{|l|c|c|c|c|c|c|}
\hline
\multirow{2}{*}{Dataset Name} & \multicolumn{4}{c|}{Statistics}                                                & \multicolumn{2}{c|}{Node-Labels/Node-Attributes (Dim.)}                            \\ \cline{2-7} 
                              & \#Graphs & \#Classes & Avg. \#Nodes & Avg. \#Edges & Node-Lab. & Node-Attr.   \\ \hline
AIDS                          & 2000           & 2               & 15.69                & 16.20                & +           & + (4)                             \\ \hline
BZR                           & 405            & 2               & 35.75                & 38.36                & +           & + (3)                             \\ \hline
COLLAB                        & 5000           & 3               & 74.49                & 2457.78              & –           & –                                 \\ \hline
DD                            & 1178           & 2               & 284.32               & 715.66               & +           & –                                 \\ \hline
ENZYMES                       & 600            & 6               & 32.63                & 62.14                & +           & + (18)                            \\ \hline
IMDB-BINARY                   & 1000           & 2               & 19.77                & 96.53                & –           & –                                 \\ \hline
IMDB-MULTI                    & 1500           & 3               & 13.00                & 65.94                & –           & –                                 \\ \hline
MUTAG                         & 188            & 2               & 17.93                & 19.79                & +           & –                                 \\ \hline
PTC\_MR                       & 344            & 2               & 14.29                & 14.69                & +           & –                                 \\ \hline
PROTEINS                      & 1113           & 2               & 39.06                & 72.82                & +           & + (1)                             \\ \hline
PROTEINS\_full                & 1113           & 2               & 39.06                & 72.82                & +           & + (29)                            \\ \hline
REDDIT-BINARY                 & 2000           & 2               & 429.63               & 497.75               & –           & –                                 \\ \hline
REDDIT-MULTI-5k               & 4999           & 5               & 508.52               & 594.87               & –           & –                                 \\ \hline
REDDIT-MULTI-12k              & 11929          & 11              & 391.41               & 456.89               & –           & –                                 \\ \hline
SYNTHETICnew                  & 300            & 2               & 100.00               & 196.25               & –           & + (1)                             \\ \hline
Synthie                       & 400            & 4               & 95.00                & 172.93               & –           & + (15)                            \\ \hline
\end{tabularx}
}
}
\end{adjustbox}
\caption{Στατιστικά στοιχεία για τα σύνολα δεδομένων καθώς και πληροφορίες σχετικά με την ύπαρξη και τoν τύπo των επισημειώσεων.}
\label{ref:dataset_statistics}
\end{table}
\section{Αποτελεσμάτα \& Αξιολόγηση}

\section{Συμπεράσματα και μελλοντικές επεκτάσεις}
